2025-05-10 16:43:24,594 | INFO | üìÑ Starting processing file: 2025 - 01 - 01- Night Audit Packet.pdf
2025-05-10 16:43:24,631 | INFO | üìÑ Starting processing file: 2025 - 01 - 02- Night Audit Packet.pdf
2025-05-10 16:43:24,738 | INFO | üìÑ Starting processing file: 2025 - 01 - 03- Night Audit Packet.pdf
2025-05-10 16:43:24,745 | INFO | üìÑ Starting processing file: 2025 - 01 - 04- Night Audit Packet.pdf
2025-05-10 16:43:24,780 | INFO | üìÑ Starting processing file: 2025 - 01 - 05- Night Audit Packet.pdf
2025-05-10 16:43:24,790 | INFO | üìÑ Starting processing file: 2025 - 01 - 06- Night Audit Packet.pdf
2025-05-10 16:43:24,813 | INFO | üìÑ Starting processing file: 2025 - 01 - 07- Night Audit Packet.pdf
2025-05-10 16:43:24,814 | INFO | üìÑ Starting processing file: 2025 - 01 - 08- Night Audit Packet.pdf
2025-05-10 16:43:53,152 | ERROR | ‚ùå A/R Aging extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-03' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 550.0, 'days_30': 325.0, 'days_60': 225.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72798.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '169773-FL453-2025-01-03' for key 'ar_aging.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-03' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 550.0, 'days_30': 325.0, 'days_60': 225.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72798.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115596)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:43:53,152 | ERROR | ‚ùå A/R Aging extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-02' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 525.0, 'days_30': 325.0, 'days_60': 225.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72773.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '169773-FL453-2025-01-02' for key 'ar_aging.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-02' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 525.0, 'days_30': 325.0, 'days_60': 225.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72773.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 115748)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:43:53,646 | ERROR | ‚ùå A/R Aging extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-05' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 550.0, 'days_30': 325.0, 'days_60': 250.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72823.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '169773-FL453-2025-01-05' for key 'ar_aging.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-05' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 550.0, 'days_30': 325.0, 'days_60': 250.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72823.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 625738)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:43:53,944 | ERROR | ‚ùå A/R Aging extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-04' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 525.0, 'days_30': 325.0, 'days_60': 250.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72798.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '169773-FL453-2025-01-04' for key 'ar_aging.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-04' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 525.0, 'days_30': 325.0, 'days_60': 250.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72798.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 922832)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:43:53,946 | ERROR | ‚ùå A/R Aging extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-06' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 500.0, 'days_30': 400.0, 'days_60': 250.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72848.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '169773-FL453-2025-01-06' for key 'ar_aging.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-06' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 500.0, 'days_30': 400.0, 'days_60': 250.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72848.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 921758)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:43:53,946 | ERROR | ‚ùå A/R Aging extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-07' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 500.0, 'days_30': 400.0, 'days_60': 250.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72848.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '169773-FL453-2025-01-07' for key 'ar_aging.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-07' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 500.0, 'days_30': 400.0, 'days_60': 250.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72848.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 53, 925939)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:43:54,412 | ERROR | ‚ùå A/R Aging extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-08' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 575.0, 'days_30': 375.0, 'days_60': 275.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72923.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '169773-FL453-2025-01-08' for key 'ar_aging.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-08' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 575.0, 'days_30': 375.0, 'days_60': 275.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72923.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 378940)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:43:54,634 | ERROR | ‚ùå A/R Aging extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-09' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 525.0, 'days_30': 475.0, 'days_60': 275.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72973.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '169773-FL453-2025-01-09' for key 'ar_aging.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '169773-FL453-2025-01-09' for key 'ar_aging.PRIMARY'
[SQL: INSERT INTO ar_aging (account, guest_name, current, days_30, days_60, days_90, days_120, credits, balance, limit_amount, property_code, user, report_date, source_file, load_timestamp) VALUES (%(account)s, %(guest_name)s, %(current)s, %(days_30)s, %(days_60)s, %(days_90)s, %(days_120)s, %(credits)s, %(balance)s, %(limit_amount)s, %(property_code)s, %(user)s, %(report_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'account': '169773', 'guest_name': 'CHOICE PRIVILEGES A/R ACCT# 106', 'current': 525.0, 'days_30': 475.0, 'days_60': 275.66, 'days_90': 0.0, 'days_120': 71698.11, 'credits': 0.0, 'balance': 72973.77, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '447128', 'guest_name': 'CORPORATE LODGING CONSULTANTS', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 130722.73, 'credits': -6.26, 'balance': 130722.73, 'limit_amount': 10000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1262583', 'guest_name': 'NWFL SYMPHONY ORCHESTRA', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 75.47, 'credits': 0.0, 'balance': 75.47, 'limit_amount': 5000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1459824', 'guest_name': 'H20 PRUF, LLC', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 639.18, 'credits': 0.0, 'balance': 639.18, 'limit_amount': 1500.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1526533', 'guest_name': 'DELTA AIRLINES INC.', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 908.93, 'credits': 0.0, 'balance': 908.93, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1530547', 'guest_name': 'Unpaid Folios', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 9485.14, 'credits': 0.0, 'balance': 9485.14, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1557431', 'guest_name': 'HALPERNS SEAFOOD', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 201.4, 'credits': 0.0, 'balance': 201.4, 'limit_amount': 2000.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '1607500', 'guest_name': 'Thunderbird', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 301.0, 'credits': 0.0, 'balance': 301.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}  ... displaying 10 of 32 total bound parameter sets ...  {'account': '3448722', 'guest_name': 'Niceville Housing Authority', 'current': 0.0, 'days_30': 0.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 516.0, 'credits': 0.0, 'balance': 516.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)}, {'account': '3601939', 'guest_name': 'Stuckman Tree Cutting Company', 'current': 0.0, 'days_30': 960.0, 'days_60': 0.0, 'days_90': 0.0, 'days_120': 0.0, 'credits': 0.0, 'balance': 960.0, 'limit_amount': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'report_date': datetime.date(2025, 1, 9), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 43, 54, 611992)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:44:03,306 | ERROR | ‚ùå Transaction Closeout extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-02' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': 0.0, 'todays_total': -25.0, 'todays_adjustments': 0.0, 'todays_net': -25.0, 'ptd_totals': -25.0, 'ytd_totals': -25.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 0.0, 'todays_total': 25.0, 'todays_adjustments': 0.0, 'todays_net': 25.0, 'ptd_totals': 25.0, 'ytd_totals': 25.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Cash (CA)', 'opening_balance': -68.95, 'todays_total': -68.95, 'todays_adjustments': 0.0, 'todays_net': -68.95, 'ptd_totals': -137.9, 'ytd_totals': -137.9, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Total For CASH:', 'opening_balance': -68.95, 'todays_total': -68.95, 'todays_adjustments': 0.0, 'todays_net': -68.95, 'ptd_totals': -137.9, 'ytd_totals': -137.9, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'American Express (AX)', 'opening_balance': 0.0, 'todays_total': -784.18, 'todays_adjustments': 0.0, 'todays_net': -784.18, 'ptd_totals': -784.18, 'ytd_totals': -784.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Master Card (MC)', 'opening_balance': 0.0, 'todays_total': -131.18, 'todays_adjustments': 0.0, 'todays_net': -131.18, 'ptd_totals': -131.18, 'ytd_totals': -131.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Visa Payment (VI)', 'opening_balance': -142.49, 'todays_total': -525.0, 'todays_adjustments': 0.0, 'todays_net': -525.0, 'ptd_totals': -667.49, 'ytd_totals': -667.49, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 74.89, 'todays_total': 80.59, 'todays_adjustments': 0.0, 'todays_net': 80.59, 'ptd_totals': 155.48, 'ytd_totals': 155.48, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Total For TAX:', 'opening_balance': 179.73, 'todays_total': 193.39, 'todays_adjustments': 0.0, 'todays_net': 193.39, 'ptd_totals': 373.12, 'ytd_totals': 373.12, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-02' for key 'transaction_closeout.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-02' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': 0.0, 'todays_total': -25.0, 'todays_adjustments': 0.0, 'todays_net': -25.0, 'ptd_totals': -25.0, 'ytd_totals': -25.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 0.0, 'todays_total': 25.0, 'todays_adjustments': 0.0, 'todays_net': 25.0, 'ptd_totals': 25.0, 'ytd_totals': 25.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Cash (CA)', 'opening_balance': -68.95, 'todays_total': -68.95, 'todays_adjustments': 0.0, 'todays_net': -68.95, 'ptd_totals': -137.9, 'ytd_totals': -137.9, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Total For CASH:', 'opening_balance': -68.95, 'todays_total': -68.95, 'todays_adjustments': 0.0, 'todays_net': -68.95, 'ptd_totals': -137.9, 'ytd_totals': -137.9, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'American Express (AX)', 'opening_balance': 0.0, 'todays_total': -784.18, 'todays_adjustments': 0.0, 'todays_net': -784.18, 'ptd_totals': -784.18, 'ytd_totals': -784.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Master Card (MC)', 'opening_balance': 0.0, 'todays_total': -131.18, 'todays_adjustments': 0.0, 'todays_net': -131.18, 'ptd_totals': -131.18, 'ytd_totals': -131.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Visa Payment (VI)', 'opening_balance': -142.49, 'todays_total': -525.0, 'todays_adjustments': 0.0, 'todays_net': -525.0, 'ptd_totals': -667.49, 'ytd_totals': -667.49, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 74.89, 'todays_total': 80.59, 'todays_adjustments': 0.0, 'todays_net': 80.59, 'ptd_totals': 155.48, 'ytd_totals': 155.48, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)}, {'description': 'Total For TAX:', 'opening_balance': 179.73, 'todays_total': 193.39, 'todays_adjustments': 0.0, 'todays_net': 193.39, 'ptd_totals': 373.12, 'ytd_totals': 373.12, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 2), 'source_file': '2025 - 01 - 02- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275410)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:44:03,306 | ERROR | ‚ùå Transaction Closeout extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Cash (CA)-FL453-2025-01-01' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Cash (CA)', 'opening_balance': 0.0, 'todays_total': -68.95, 'todays_adjustments': 0.0, 'todays_net': -68.95, 'ptd_totals': -68.95, 'ytd_totals': -68.95, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Total For CASH:', 'opening_balance': 0.0, 'todays_total': -68.95, 'todays_adjustments': 0.0, 'todays_net': -68.95, 'ptd_totals': -68.95, 'ytd_totals': -68.95, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Visa Payment (VI)', 'opening_balance': 0.0, 'todays_total': -142.49, 'todays_adjustments': 0.0, 'todays_net': -142.49, 'ptd_totals': -142.49, 'ytd_totals': -142.49, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Total For CREDIT CARDS:', 'opening_balance': 0.0, 'todays_total': -142.49, 'todays_adjustments': 0.0, 'todays_net': -142.49, 'ptd_totals': -142.49, 'ytd_totals': -142.49, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Room Charge (RM)', 'opening_balance': 0.0, 'todays_total': 1579.74, 'todays_adjustments': 0.0, 'todays_net': 1579.74, 'ptd_totals': 1579.74, 'ytd_totals': 1579.74, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Total For ROOM REVENUE:', 'opening_balance': 0.0, 'todays_total': 1579.74, 'todays_adjustments': 0.0, 'todays_net': 1579.74, 'ptd_totals': 1579.74, 'ytd_totals': 1579.74, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'State Tax (T1)', 'opening_balance': 0.0, 'todays_total': 104.84, 'todays_adjustments': 0.0, 'todays_net': 104.84, 'ptd_totals': 104.84, 'ytd_totals': 104.84, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Tourism Tax (T5)', 'opening_balance': 0.0, 'todays_total': 74.89, 'todays_adjustments': 0.0, 'todays_net': 74.89, 'ptd_totals': 74.89, 'ytd_totals': 74.89, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Total For TAX:', 'opening_balance': 0.0, 'todays_total': 179.73, 'todays_adjustments': 0.0, 'todays_net': 179.73, 'ptd_totals': 179.73, 'ytd_totals': 179.73, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry 'Cash (CA)-FL453-2025-01-01' for key 'transaction_closeout.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Cash (CA)-FL453-2025-01-01' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Cash (CA)', 'opening_balance': 0.0, 'todays_total': -68.95, 'todays_adjustments': 0.0, 'todays_net': -68.95, 'ptd_totals': -68.95, 'ytd_totals': -68.95, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Total For CASH:', 'opening_balance': 0.0, 'todays_total': -68.95, 'todays_adjustments': 0.0, 'todays_net': -68.95, 'ptd_totals': -68.95, 'ytd_totals': -68.95, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Visa Payment (VI)', 'opening_balance': 0.0, 'todays_total': -142.49, 'todays_adjustments': 0.0, 'todays_net': -142.49, 'ptd_totals': -142.49, 'ytd_totals': -142.49, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Total For CREDIT CARDS:', 'opening_balance': 0.0, 'todays_total': -142.49, 'todays_adjustments': 0.0, 'todays_net': -142.49, 'ptd_totals': -142.49, 'ytd_totals': -142.49, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Room Charge (RM)', 'opening_balance': 0.0, 'todays_total': 1579.74, 'todays_adjustments': 0.0, 'todays_net': 1579.74, 'ptd_totals': 1579.74, 'ytd_totals': 1579.74, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Total For ROOM REVENUE:', 'opening_balance': 0.0, 'todays_total': 1579.74, 'todays_adjustments': 0.0, 'todays_net': 1579.74, 'ptd_totals': 1579.74, 'ytd_totals': 1579.74, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'State Tax (T1)', 'opening_balance': 0.0, 'todays_total': 104.84, 'todays_adjustments': 0.0, 'todays_net': 104.84, 'ptd_totals': 104.84, 'ytd_totals': 104.84, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Tourism Tax (T5)', 'opening_balance': 0.0, 'todays_total': 74.89, 'todays_adjustments': 0.0, 'todays_net': 74.89, 'ptd_totals': 74.89, 'ytd_totals': 74.89, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)}, {'description': 'Total For TAX:', 'opening_balance': 0.0, 'todays_total': 179.73, 'todays_adjustments': 0.0, 'todays_net': 179.73, 'ptd_totals': 179.73, 'ytd_totals': 179.73, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 1), 'source_file': '2025 - 01 - 01- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 275554)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:44:03,371 | INFO | ‚úÖ Processed In-House List
2025-05-10 16:44:03,371 | INFO | ‚úÖ Processed In-House List
2025-05-10 16:44:03,747 | ERROR | ‚ùå Transaction Closeout extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-04' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -97.8, 'todays_total': -389.0, 'todays_adjustments': 0.0, 'todays_net': -389.0, 'ptd_totals': -486.8, 'ytd_totals': -486.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 97.8, 'todays_total': 389.0, 'todays_adjustments': 0.0, 'todays_net': 389.0, 'ptd_totals': 486.8, 'ytd_totals': 486.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Cash (CA)', 'opening_balance': -203.4, 'todays_total': -142.78, 'todays_adjustments': 0.0, 'todays_net': -142.78, 'ptd_totals': -346.18, 'ytd_totals': -346.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Total For CASH:', 'opening_balance': -203.4, 'todays_total': -142.78, 'todays_adjustments': 0.0, 'todays_net': -142.78, 'ptd_totals': -346.18, 'ytd_totals': -346.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'American Express (AX)', 'opening_balance': -784.18, 'todays_total': -537.6, 'todays_adjustments': 0.0, 'todays_net': -537.6, 'ptd_totals': -1321.78, 'ytd_totals': -1321.78, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Master Card (MC)', 'opening_balance': -557.59, 'todays_total': -265.56, 'todays_adjustments': 0.0, 'todays_net': -265.56, 'ptd_totals': -823.15, 'ytd_totals': -823.15, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Visa Payment (VI)', 'opening_balance': -894.85, 'todays_total': -375.06, 'todays_adjustments': 0.0, 'todays_net': -375.06, 'ptd_totals': -1269.91, 'ytd_totals': -1269.91, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 237.05, 'todays_total': 69.37, 'todays_adjustments': -6.5, 'todays_net': 62.87, 'ptd_totals': 299.92, 'ytd_totals': 299.92, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Total For TAX:', 'opening_balance': 568.89, 'todays_total': 166.49, 'todays_adjustments': -15.6, 'todays_net': 150.89, 'ptd_totals': 719.78, 'ytd_totals': 719.78, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-04' for key 'transaction_closeout.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-04' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -97.8, 'todays_total': -389.0, 'todays_adjustments': 0.0, 'todays_net': -389.0, 'ptd_totals': -486.8, 'ytd_totals': -486.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 97.8, 'todays_total': 389.0, 'todays_adjustments': 0.0, 'todays_net': 389.0, 'ptd_totals': 486.8, 'ytd_totals': 486.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Cash (CA)', 'opening_balance': -203.4, 'todays_total': -142.78, 'todays_adjustments': 0.0, 'todays_net': -142.78, 'ptd_totals': -346.18, 'ytd_totals': -346.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Total For CASH:', 'opening_balance': -203.4, 'todays_total': -142.78, 'todays_adjustments': 0.0, 'todays_net': -142.78, 'ptd_totals': -346.18, 'ytd_totals': -346.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'American Express (AX)', 'opening_balance': -784.18, 'todays_total': -537.6, 'todays_adjustments': 0.0, 'todays_net': -537.6, 'ptd_totals': -1321.78, 'ytd_totals': -1321.78, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Master Card (MC)', 'opening_balance': -557.59, 'todays_total': -265.56, 'todays_adjustments': 0.0, 'todays_net': -265.56, 'ptd_totals': -823.15, 'ytd_totals': -823.15, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Visa Payment (VI)', 'opening_balance': -894.85, 'todays_total': -375.06, 'todays_adjustments': 0.0, 'todays_net': -375.06, 'ptd_totals': -1269.91, 'ytd_totals': -1269.91, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 237.05, 'todays_total': 69.37, 'todays_adjustments': -6.5, 'todays_net': 62.87, 'ptd_totals': 299.92, 'ytd_totals': 299.92, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)}, {'description': 'Total For TAX:', 'opening_balance': 568.89, 'todays_total': 166.49, 'todays_adjustments': -15.6, 'todays_net': 150.89, 'ptd_totals': 719.78, 'ytd_totals': 719.78, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 4), 'source_file': '2025 - 01 - 04- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 3, 714906)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:44:03,781 | INFO | ‚úÖ Processed In-House List
2025-05-10 16:44:04,110 | ERROR | ‚ùå Transaction Closeout extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-03' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -25.0, 'todays_total': -72.8, 'todays_adjustments': 0.0, 'todays_net': -72.8, 'ptd_totals': -97.8, 'ytd_totals': -97.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 25.0, 'todays_total': 72.8, 'todays_adjustments': 0.0, 'todays_net': 72.8, 'ptd_totals': 97.8, 'ytd_totals': 97.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Cash (CA)', 'opening_balance': -137.9, 'todays_total': -65.5, 'todays_adjustments': 0.0, 'todays_net': -65.5, 'ptd_totals': -203.4, 'ytd_totals': -203.4, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Total For CASH:', 'opening_balance': -137.9, 'todays_total': -65.5, 'todays_adjustments': 0.0, 'todays_net': -65.5, 'ptd_totals': -203.4, 'ytd_totals': -203.4, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'American Express (AX)', 'opening_balance': -784.18, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -784.18, 'ytd_totals': -784.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Master Card (MC)', 'opening_balance': -131.18, 'todays_total': -426.41, 'todays_adjustments': 0.0, 'todays_net': -426.41, 'ptd_totals': -557.59, 'ytd_totals': -557.59, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Visa Payment (VI)', 'opening_balance': -667.49, 'todays_total': -227.36, 'todays_adjustments': 0.0, 'todays_net': -227.36, 'ptd_totals': -894.85, 'ytd_totals': -894.85, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 155.48, 'todays_total': 81.57, 'todays_adjustments': 0.0, 'todays_net': 81.57, 'ptd_totals': 237.05, 'ytd_totals': 237.05, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Total For TAX:', 'opening_balance': 373.12, 'todays_total': 195.77, 'todays_adjustments': 0.0, 'todays_net': 195.77, 'ptd_totals': 568.89, 'ytd_totals': 568.89, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-03' for key 'transaction_closeout.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-03' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -25.0, 'todays_total': -72.8, 'todays_adjustments': 0.0, 'todays_net': -72.8, 'ptd_totals': -97.8, 'ytd_totals': -97.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 25.0, 'todays_total': 72.8, 'todays_adjustments': 0.0, 'todays_net': 72.8, 'ptd_totals': 97.8, 'ytd_totals': 97.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Cash (CA)', 'opening_balance': -137.9, 'todays_total': -65.5, 'todays_adjustments': 0.0, 'todays_net': -65.5, 'ptd_totals': -203.4, 'ytd_totals': -203.4, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Total For CASH:', 'opening_balance': -137.9, 'todays_total': -65.5, 'todays_adjustments': 0.0, 'todays_net': -65.5, 'ptd_totals': -203.4, 'ytd_totals': -203.4, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'American Express (AX)', 'opening_balance': -784.18, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -784.18, 'ytd_totals': -784.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Master Card (MC)', 'opening_balance': -131.18, 'todays_total': -426.41, 'todays_adjustments': 0.0, 'todays_net': -426.41, 'ptd_totals': -557.59, 'ytd_totals': -557.59, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Visa Payment (VI)', 'opening_balance': -667.49, 'todays_total': -227.36, 'todays_adjustments': 0.0, 'todays_net': -227.36, 'ptd_totals': -894.85, 'ytd_totals': -894.85, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 155.48, 'todays_total': 81.57, 'todays_adjustments': 0.0, 'todays_net': 81.57, 'ptd_totals': 237.05, 'ytd_totals': 237.05, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)}, {'description': 'Total For TAX:', 'opening_balance': 373.12, 'todays_total': 195.77, 'todays_adjustments': 0.0, 'todays_net': 195.77, 'ptd_totals': 568.89, 'ytd_totals': 568.89, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 3), 'source_file': '2025 - 01 - 03- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69171)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:44:04,110 | ERROR | ‚ùå Transaction Closeout extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-06' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -511.8, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -511.8, 'ytd_totals': -511.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 511.8, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 511.8, 'ytd_totals': 511.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Cash (CA)', 'opening_balance': -560.29, 'todays_total': -214.11, 'todays_adjustments': 0.0, 'todays_net': -214.11, 'ptd_totals': -774.4, 'ytd_totals': -774.4, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Total For CASH:', 'opening_balance': -560.29, 'todays_total': -214.11, 'todays_adjustments': 0.0, 'todays_net': -214.11, 'ptd_totals': -774.4, 'ytd_totals': -774.4, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'American Express (AX)', 'opening_balance': -3270.58, 'todays_total': 0.0, 'todays_adjustments': 703.54, 'todays_net': 703.54, 'ptd_totals': -2567.04, 'ytd_totals': -2567.04, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Master Card (MC)', 'opening_balance': -823.15, 'todays_total': -645.65, 'todays_adjustments': 0.0, 'todays_net': -645.65, 'ptd_totals': -1468.8, 'ytd_totals': -1468.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Visa Payment (VI)', 'opening_balance': -1269.91, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -1269.91, 'ytd_totals': -1269.91, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 376.61, 'todays_total': 80.38, 'todays_adjustments': -2.91, 'todays_net': 77.47, 'ptd_totals': 454.08, 'ytd_totals': 454.08, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Total For TAX:', 'opening_balance': 903.82, 'todays_total': 192.91, 'todays_adjustments': -6.98, 'todays_net': 185.93, 'ptd_totals': 1089.75, 'ytd_totals': 1089.75, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-06' for key 'transaction_closeout.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-06' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -511.8, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -511.8, 'ytd_totals': -511.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 511.8, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 511.8, 'ytd_totals': 511.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Cash (CA)', 'opening_balance': -560.29, 'todays_total': -214.11, 'todays_adjustments': 0.0, 'todays_net': -214.11, 'ptd_totals': -774.4, 'ytd_totals': -774.4, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Total For CASH:', 'opening_balance': -560.29, 'todays_total': -214.11, 'todays_adjustments': 0.0, 'todays_net': -214.11, 'ptd_totals': -774.4, 'ytd_totals': -774.4, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'American Express (AX)', 'opening_balance': -3270.58, 'todays_total': 0.0, 'todays_adjustments': 703.54, 'todays_net': 703.54, 'ptd_totals': -2567.04, 'ytd_totals': -2567.04, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Master Card (MC)', 'opening_balance': -823.15, 'todays_total': -645.65, 'todays_adjustments': 0.0, 'todays_net': -645.65, 'ptd_totals': -1468.8, 'ytd_totals': -1468.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Visa Payment (VI)', 'opening_balance': -1269.91, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -1269.91, 'ytd_totals': -1269.91, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 376.61, 'todays_total': 80.38, 'todays_adjustments': -2.91, 'todays_net': 77.47, 'ptd_totals': 454.08, 'ytd_totals': 454.08, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)}, {'description': 'Total For TAX:', 'opening_balance': 903.82, 'todays_total': 192.91, 'todays_adjustments': -6.98, 'todays_net': 185.93, 'ptd_totals': 1089.75, 'ytd_totals': 1089.75, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 6), 'source_file': '2025 - 01 - 06- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 69332)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:44:04,119 | ERROR | ‚ùå Transaction Closeout extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-05' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -486.8, 'todays_total': -25.0, 'todays_adjustments': 0.0, 'todays_net': -25.0, 'ptd_totals': -511.8, 'ytd_totals': -511.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 486.8, 'todays_total': 25.0, 'todays_adjustments': 0.0, 'todays_net': 25.0, 'ptd_totals': 511.8, 'ytd_totals': 511.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Cash (CA)', 'opening_balance': -346.18, 'todays_total': -214.11, 'todays_adjustments': 0.0, 'todays_net': -214.11, 'ptd_totals': -560.29, 'ytd_totals': -560.29, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Total For CASH:', 'opening_balance': -346.18, 'todays_total': -214.11, 'todays_adjustments': 0.0, 'todays_net': -214.11, 'ptd_totals': -560.29, 'ytd_totals': -560.29, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'American Express (AX)', 'opening_balance': -1321.78, 'todays_total': -1948.8, 'todays_adjustments': 0.0, 'todays_net': -1948.8, 'ptd_totals': -3270.58, 'ytd_totals': -3270.58, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Master Card (MC)', 'opening_balance': -823.15, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -823.15, 'ytd_totals': -823.15, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Visa Payment (VI)', 'opening_balance': -1269.91, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -1269.91, 'ytd_totals': -1269.91, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 299.92, 'todays_total': 76.69, 'todays_adjustments': 0.0, 'todays_net': 76.69, 'ptd_totals': 376.61, 'ytd_totals': 376.61, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Total For TAX:', 'opening_balance': 719.78, 'todays_total': 184.04, 'todays_adjustments': 0.0, 'todays_net': 184.04, 'ptd_totals': 903.82, 'ytd_totals': 903.82, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-05' for key 'transaction_closeout.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-05' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -486.8, 'todays_total': -25.0, 'todays_adjustments': 0.0, 'todays_net': -25.0, 'ptd_totals': -511.8, 'ytd_totals': -511.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 486.8, 'todays_total': 25.0, 'todays_adjustments': 0.0, 'todays_net': 25.0, 'ptd_totals': 511.8, 'ytd_totals': 511.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Cash (CA)', 'opening_balance': -346.18, 'todays_total': -214.11, 'todays_adjustments': 0.0, 'todays_net': -214.11, 'ptd_totals': -560.29, 'ytd_totals': -560.29, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Total For CASH:', 'opening_balance': -346.18, 'todays_total': -214.11, 'todays_adjustments': 0.0, 'todays_net': -214.11, 'ptd_totals': -560.29, 'ytd_totals': -560.29, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'American Express (AX)', 'opening_balance': -1321.78, 'todays_total': -1948.8, 'todays_adjustments': 0.0, 'todays_net': -1948.8, 'ptd_totals': -3270.58, 'ytd_totals': -3270.58, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Master Card (MC)', 'opening_balance': -823.15, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -823.15, 'ytd_totals': -823.15, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Visa Payment (VI)', 'opening_balance': -1269.91, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -1269.91, 'ytd_totals': -1269.91, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 299.92, 'todays_total': 76.69, 'todays_adjustments': 0.0, 'todays_net': 76.69, 'ptd_totals': 376.61, 'ytd_totals': 376.61, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)}, {'description': 'Total For TAX:', 'opening_balance': 719.78, 'todays_total': 184.04, 'todays_adjustments': 0.0, 'todays_net': 184.04, 'ptd_totals': 903.82, 'ytd_totals': 903.82, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 5), 'source_file': '2025 - 01 - 05- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 83856)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:44:04,147 | INFO | ‚úÖ Processed In-House List
2025-05-10 16:44:04,147 | INFO | ‚úÖ Processed In-House List
2025-05-10 16:44:04,147 | INFO | ‚úÖ Processed In-House List
2025-05-10 16:44:04,505 | ERROR | ‚ùå Transaction Closeout extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-07' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -511.8, 'todays_total': -75.0, 'todays_adjustments': 0.0, 'todays_net': -75.0, 'ptd_totals': -586.8, 'ytd_totals': -586.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 511.8, 'todays_total': 75.0, 'todays_adjustments': 0.0, 'todays_net': 75.0, 'ptd_totals': 586.8, 'ytd_totals': 586.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Cash (CA)', 'opening_balance': -774.4, 'todays_total': -156.55, 'todays_adjustments': 0.0, 'todays_net': -156.55, 'ptd_totals': -930.95, 'ytd_totals': -930.95, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Total For CASH:', 'opening_balance': -774.4, 'todays_total': -156.55, 'todays_adjustments': 0.0, 'todays_net': -156.55, 'ptd_totals': -930.95, 'ytd_totals': -930.95, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'American Express (AX)', 'opening_balance': -2567.04, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -2567.04, 'ytd_totals': -2567.04, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Master Card (MC)', 'opening_balance': -1468.8, 'todays_total': -389.38, 'todays_adjustments': 0.0, 'todays_net': -389.38, 'ptd_totals': -1858.18, 'ytd_totals': -1858.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Visa Payment (VI)', 'opening_balance': -1269.91, 'todays_total': -721.17, 'todays_adjustments': 0.0, 'todays_net': -721.17, 'ptd_totals': -1991.08, 'ytd_totals': -1991.08, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 454.08, 'todays_total': 83.74, 'todays_adjustments': 0.0, 'todays_net': 83.74, 'ptd_totals': 537.82, 'ytd_totals': 537.82, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Total For TAX:', 'opening_balance': 1089.75, 'todays_total': 200.97, 'todays_adjustments': 0.0, 'todays_net': 200.97, 'ptd_totals': 1290.72, 'ytd_totals': 1290.72, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-07' for key 'transaction_closeout.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-07' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -511.8, 'todays_total': -75.0, 'todays_adjustments': 0.0, 'todays_net': -75.0, 'ptd_totals': -586.8, 'ytd_totals': -586.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 511.8, 'todays_total': 75.0, 'todays_adjustments': 0.0, 'todays_net': 75.0, 'ptd_totals': 586.8, 'ytd_totals': 586.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Cash (CA)', 'opening_balance': -774.4, 'todays_total': -156.55, 'todays_adjustments': 0.0, 'todays_net': -156.55, 'ptd_totals': -930.95, 'ytd_totals': -930.95, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Total For CASH:', 'opening_balance': -774.4, 'todays_total': -156.55, 'todays_adjustments': 0.0, 'todays_net': -156.55, 'ptd_totals': -930.95, 'ytd_totals': -930.95, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'American Express (AX)', 'opening_balance': -2567.04, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -2567.04, 'ytd_totals': -2567.04, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Master Card (MC)', 'opening_balance': -1468.8, 'todays_total': -389.38, 'todays_adjustments': 0.0, 'todays_net': -389.38, 'ptd_totals': -1858.18, 'ytd_totals': -1858.18, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Visa Payment (VI)', 'opening_balance': -1269.91, 'todays_total': -721.17, 'todays_adjustments': 0.0, 'todays_net': -721.17, 'ptd_totals': -1991.08, 'ytd_totals': -1991.08, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 454.08, 'todays_total': 83.74, 'todays_adjustments': 0.0, 'todays_net': 83.74, 'ptd_totals': 537.82, 'ytd_totals': 537.82, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)}, {'description': 'Total For TAX:', 'opening_balance': 1089.75, 'todays_total': 200.97, 'todays_adjustments': 0.0, 'todays_net': 200.97, 'ptd_totals': 1290.72, 'ytd_totals': 1290.72, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 7), 'source_file': '2025 - 01 - 07- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 474974)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:44:04,538 | INFO | ‚úÖ Processed In-House List
2025-05-10 16:44:04,723 | ERROR | ‚ùå Transaction Closeout extraction failed: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-08' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -586.8, 'todays_total': -50.0, 'todays_adjustments': 0.0, 'todays_net': -50.0, 'ptd_totals': -636.8, 'ytd_totals': -636.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 586.8, 'todays_total': 50.0, 'todays_adjustments': 0.0, 'todays_net': 50.0, 'ptd_totals': 636.8, 'ytd_totals': 636.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Cash (CA)', 'opening_balance': -930.95, 'todays_total': -69.91, 'todays_adjustments': 0.0, 'todays_net': -69.91, 'ptd_totals': -1000.86, 'ytd_totals': -1000.86, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Total For CASH:', 'opening_balance': -930.95, 'todays_total': -69.91, 'todays_adjustments': 0.0, 'todays_net': -69.91, 'ptd_totals': -1000.86, 'ytd_totals': -1000.86, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'American Express (AX)', 'opening_balance': -2567.04, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -2567.04, 'ytd_totals': -2567.04, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Master Card (MC)', 'opening_balance': -1858.18, 'todays_total': -343.94, 'todays_adjustments': 0.0, 'todays_net': -343.94, 'ptd_totals': -2202.12, 'ytd_totals': -2202.12, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Visa Payment (VI)', 'opening_balance': -1991.08, 'todays_total': -473.92, 'todays_adjustments': 0.0, 'todays_net': -473.92, 'ptd_totals': -2465.0, 'ytd_totals': -2465.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 537.82, 'todays_total': 86.47, 'todays_adjustments': 0.0, 'todays_net': 86.47, 'ptd_totals': 624.29, 'ytd_totals': 624.29, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Total For TAX:', 'opening_balance': 1290.72, 'todays_total': 207.53, 'todays_adjustments': 0.0, 'todays_net': 207.53, 'ptd_totals': 1498.25, 'ytd_totals': 1498.25, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-08' for key 'transaction_closeout.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/processor.py", line 74, in handle_section
    insert_dataframe(engine, df, table_name, filename)
  File "/Users/sandeepmalkanoor/Documents/Python/Night_Audit_DataEngineering_Project/night_audit_etl_pipeline/db_utils.py", line 45, in insert_dataframe
    df.to_sql(table_name, con=engine, if_exists='append', index=False)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/opt/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/opt/anaconda3/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 643, in executemany
    return self.execute(stmt)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/cursor.py", line 537, in execute
    self._handle_result(self._connection.cmd_query(stmt))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 872, in cmd_query
    result = self._handle_result(self._send_cmd(ServerCmd.QUERY, query))
  File "/opt/anaconda3/lib/python3.9/site-packages/mysql/connector/connection.py", line 648, in _handle_result
    raise get_exception(packet)
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry 'Direct Bill (DB)-FL453-2025-01-08' for key 'transaction_closeout.PRIMARY'
[SQL: INSERT INTO transaction_closeout (description, opening_balance, todays_total, todays_adjustments, todays_net, ptd_totals, ytd_totals, property_code, user, business_date, source_file, load_timestamp) VALUES (%(description)s, %(opening_balance)s, %(todays_total)s, %(todays_adjustments)s, %(todays_net)s, %(ptd_totals)s, %(ytd_totals)s, %(property_code)s, %(user)s, %(business_date)s, %(source_file)s, %(load_timestamp)s)]
[parameters: ({'description': 'Direct Bill (DB)', 'opening_balance': -586.8, 'todays_total': -50.0, 'todays_adjustments': 0.0, 'todays_net': -50.0, 'ptd_totals': -636.8, 'ytd_totals': -636.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Direct Billing Receivable (DR)', 'opening_balance': 586.8, 'todays_total': 50.0, 'todays_adjustments': 0.0, 'todays_net': 50.0, 'ptd_totals': 636.8, 'ytd_totals': 636.8, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'RECEIVABLE:', 'opening_balance': 0.0, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': 0.0, 'ytd_totals': 0.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Cash (CA)', 'opening_balance': -930.95, 'todays_total': -69.91, 'todays_adjustments': 0.0, 'todays_net': -69.91, 'ptd_totals': -1000.86, 'ytd_totals': -1000.86, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Total For CASH:', 'opening_balance': -930.95, 'todays_total': -69.91, 'todays_adjustments': 0.0, 'todays_net': -69.91, 'ptd_totals': -1000.86, 'ytd_totals': -1000.86, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'American Express (AX)', 'opening_balance': -2567.04, 'todays_total': 0.0, 'todays_adjustments': 0.0, 'todays_net': 0.0, 'ptd_totals': -2567.04, 'ytd_totals': -2567.04, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Master Card (MC)', 'opening_balance': -1858.18, 'todays_total': -343.94, 'todays_adjustments': 0.0, 'todays_net': -343.94, 'ptd_totals': -2202.12, 'ytd_totals': -2202.12, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Visa Payment (VI)', 'opening_balance': -1991.08, 'todays_total': -473.92, 'todays_adjustments': 0.0, 'todays_net': -473.92, 'ptd_totals': -2465.0, 'ytd_totals': -2465.0, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}  ... displaying 10 of 14 total bound parameter sets ...  {'description': 'Tourism Tax (T5)', 'opening_balance': 537.82, 'todays_total': 86.47, 'todays_adjustments': 0.0, 'todays_net': 86.47, 'ptd_totals': 624.29, 'ytd_totals': 624.29, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)}, {'description': 'Total For TAX:', 'opening_balance': 1290.72, 'todays_total': 207.53, 'todays_adjustments': 0.0, 'todays_net': 207.53, 'ptd_totals': 1498.25, 'ytd_totals': 1498.25, 'property_code': 'FL453', 'user': 'reaga.fl453', 'business_date': datetime.date(2025, 1, 8), 'source_file': '2025 - 01 - 08- Night Audit Packet.pdf', 'load_timestamp': datetime.datetime(2025, 5, 10, 16, 44, 4, 699595)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)

2025-05-10 16:44:04,742 | INFO | ‚úÖ Processed In-House List
